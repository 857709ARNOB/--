function doGet() {
  return HtmlService.createTemplateFromFile('Index')
      .evaluate()
      .setTitle('Search')
      .setSandboxMode(HtmlService.SandboxMode.IFRAME)
      .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)
      .addMetaTag('viewport', 'width=device-width, initial-scale=1')
      .setFaviconUrl('https://www.freeiconspng.com/uploads/search-icon-png-33.png'); 
}

function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename)
    .getContent();
}

function searchData(searchTerm) {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sheetNames = ["ENTRY FROM"];
  var allResults = [];
  sheetNames.forEach(function(sheetName) {
    var sheet = spreadsheet.getSheetByName(sheetName);
    if (sheet) {
      var data = sheet.getDataRange().getValues();
      var results = searchInSheet(data, searchTerm);
      allResults = allResults.concat(results);
    }
  });
  return allResults;
}

function searchInSheet(data, searchTerm) {
  var results = [];
  data.forEach(function(row) {
    if (row[0].toString().toLowerCase().indexOf(searchTerm.toLowerCase()) !== -1 || 
        row[1].toString().toLowerCase().indexOf(searchTerm.toLowerCase()) !== -1) {
      results.push(row);
    }
  });
  return results;
}
